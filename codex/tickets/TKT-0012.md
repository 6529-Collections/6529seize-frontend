---
created: 2025-10-16
id: TKT-0012
owner: openai-assistant
priority: P1
status: In-Progress
title: Refactor wave group edit buttons for modular clarity
---

## Context

> The `WaveGroupEditButtons` component has accreted mixed responsibilities spanning UI composition, event wiring, and conditional logic. This refactor extracts reusable building blocks while preserving runtime behaviour, visuals, and typing guarantees.

## Plan

- [x] Audit existing component structure, state and handler responsibilities.
- [x] Propose modular breakdown across subcomponents, hooks, and helpers aligned with project conventions.
- [x] Implement refactor with behaviour parity and updated imports/exports.
- [ ] Validate via linting and targeted tests as required.

## Acceptance

- [ ] `WaveGroupEditButtons` rebuilt as a composition shell delegating to extracted modules.
- [ ] Behaviour, styling, and TypeScript typings remain unchanged.
- [ ] Tests and lint commands succeed without new warnings.

## Links

- Primary PR: <https://github.com/6529-Collections/6529seize-frontend/pull/1544>
- Follow-ups:
  - TKT-0014 – Replace wave publish wait with backend confirmation (target removal 2025-11-08)

## Log

- 2025-10-16T00:00:00Z – Ticket drafted and initial component audit started.
- 2025-10-16T01:00:00Z – Extracted hooks/subcomponents/utils, updated exports; TypeScript checks blocked by existing repo errors.
- 2025-10-16T01:30:00Z – Consolidated controller naming and modal handling via enum-driven API.
- 2025-10-16T02:30:00Z – Synced group edit form with excluded identity data to surface both lists in edit mode.
- 2025-10-16T02:50:00Z – Hydrated wallet upload state from incoming props so both include/exclude panels show existing counts.
- 2025-10-16T03:10:00Z – Added temporary wait after publishing groups before updating waves while we investigate backend read-after-write timing.
- 2025-10-28T09:39:26Z – Refreshed controller and menu tests to mock the query client utilities and new identity flows so they pass against the latest refactor without altering source code.
- 2025-10-21T08:44:41Z – Updated change-group action to display "Add group" when no scope exists, refreshed unit coverage, and ran targeted Jest suite.
- 2025-10-23T14:30:00Z – Routed edit menu actions through button refs to remove hidden trigger mounts and keep DOM lean.
- 2025-10-24T10:05:00Z – Logged follow-up TKT-0014 to replace the temporary publish wait with a deterministic backend confirmation path.
- 2025-10-24T14:16:46Z – Re-exported group payload validator to align with updated lint rule.
- 2025-10-25T15:05:16Z – Swapped the edit menu trigger to FontAwesome to satisfy the TSX icon guideline.
- 2025-10-25T15:10:00Z – Extracted the wave group type enum into a standalone module and updated imports to stop circular evaluation crashes in remove modal.
- 2025-10-25T15:52:57Z – Documented the combobox listbox option semantics, suppressing Sonar rule S6819 where native `<option>` elements would break the avatar-rich identity picker UI.
- 2025-10-25T16:20:00Z – Added Enter/Space keyboard activation to the listbox options to satisfy Sonar rule S1082 without altering the picker visuals.
- 2025-10-25T17:05:00Z – Removed redundant hook dependency from the identity confirm handler to keep the controller stable.
- 2025-10-26T08:23:44Z – Replaced the `Set` for-of cleanup with `forEach` to satisfy the TS target without enabling downlevel iteration.
- 2025-10-26T08:47:08Z – Extracted the gear trigger into a named component to eliminate Sonar rule S6478 in the edit menu.
- 2025-10-26T09:15:00Z – Swapped the listboxId length guard for optional chaining to resolve Sonar rule S6582 in the profile search items.
- 2025-10-26T10:45:00Z – Reused the overflow trigger component in `TabToggleWithOverflow` to silence Sonar rule S6478 by removing the inline render function.
- 2025-10-26T11:05:00Z – Restored the `for...of` cleanup on abort controllers to satisfy Sonar rule S7728 without relying on `Set.forEach`.
- 2025-10-26T11:30:00Z – Clarified identity validation messaging, simplified group publish polling, and tightened group query usage to cut redundant refetches.
- 2025-10-26T11:34:23Z – Replaced incomplete tab roles in `TabToggleWithOverflow` with toggle button semantics and added a visible focus ring to the overflow trigger.
- 2025-10-26T12:15:00Z – Reduced identity confirm controller complexity by extracting the group publish helper to satisfy Sonar rule S3776.
- 2025-10-26T12:45:00Z – Consolidated identity confirmation guards to drop the controller's cognitive complexity within Sonar limits.
- 2025-10-26T13:00:00Z – Removed the redundant fragment wrapping `AnimatePresence` in `CommonProfileSearchItems` to resolve Sonar rule S6749.
- 2025-10-26T13:30:00Z – Swapped profile search ID sanitization to `replaceAll` to resolve Sonar rule S7781 in `CommonProfileSearchItems`.
- 2025-10-26T13:45:00Z – Rebuilt the visual profile search option as a button to resolve Sonar rule S6842 without altering the picker layout.
- 2025-10-26T16:02:20Z – Enabled quick include/exclude identity actions without pre-existing groups, aligned naming, and routed wave updates through the shared auth helper to keep the controller logic consistent.
- 2025-10-26T16:30:00Z – Removed an inline comment from the controller hook to comply with the repository's TypeScript comment ban.
- 2025-10-28T10:17:42Z – Resolved merge conflicts across the wave group edit and identity search test suites, restoring Jest, lint, and type safety checks.
